# OCR คืออะไร? ประโยชน์และสายงานที่เหมาะสม

OCR (Optical Character Recognition) คือเทคโนโลยีที่ช่วยแปลงข้อความจากภาพหรือเอกสารสแกนให้กลายเป็นข้อความที่สามารถแก้ไขและค้นหาได้

**หลักการทำงานของ OCR**
- ระบบจะรับข้อมูลเป็นไฟล์ภาพ เช่น JPG, PNG หรือ PDF ที่มีข้อความอยู่ในภาพ
- ใช้เทคนิคการประมวลผลภาพ (Image Processing) เพื่อแยกแยะส่วนที่เป็นตัวอักษรออกจากพื้นหลัง
- นำตัวอักษรที่แยกได้ไปเปรียบเทียบกับฐานข้อมูลรูปแบบตัวอักษร (Font/Character Database) หรือใช้ AI/Deep Learning เพื่อทำนายว่าคือตัวอักษรอะไร
- ผลลัพธ์ที่ได้จะเป็นข้อความดิจิทัลที่สามารถนำไปใช้งานต่อได้

**ตัวอย่างการใช้งาน OCR ในชีวิตจริง**
- แปลงเอกสารราชการหรือใบเสร็จให้เป็นไฟล์ Word/Excel
- อ่านข้อมูลจากบัตรประชาชน ใบขับขี่ หรือพาสปอร์ต
- ดึงข้อมูลจากใบแจ้งหนี้ ใบกำกับภาษี หรือเอกสารทางบัญชี
- ค้นหาข้อความในเอกสารสแกนจำนวนมากอย่างรวดเร็ว

**ข้อดีของ OCR**
- ลดเวลาการพิมพ์ข้อมูลซ้ำ
- ลดข้อผิดพลาดจากการกรอกข้อมูลด้วยมือ
- ค้นหาและจัดการเอกสารได้ง่ายขึ้น
- รองรับการทำ Digital Transformation ในองค์กร

**ข้อจำกัดของ OCR**
- ความแม่นยำขึ้นกับคุณภาพของภาพและรูปแบบตัวอักษร
- อาจมีปัญหากับเอกสารที่มีรอยเปื้อน ตัวอักษรซ้อน หรือฟอนต์แปลก
- ภาษาและรูปแบบเอกสารบางประเภทอาจต้องใช้โมเดลเฉพาะทาง

OCR จึงเหมาะกับงานที่ต้องการแปลงเอกสารกระดาษเป็นดิจิทัล เช่น งานบัญชี กฎหมาย การศึกษา โลจิสติกส์ หรือธุรกิจที่ต้องจัดการเอกสารจำนวนมาก

## Mistral AI คืออะไร?

Mistral AI คือบริษัทเทคโนโลยีด้านปัญญาประดิษฐ์ (AI) จากยุโรปที่มุ่งเน้นการพัฒนาโมเดลภาษาและโซลูชัน AI สำหรับงานเอกสารและข้อมูลขนาดใหญ่ จุดเด่นของ Mistral AI คือการสร้างโมเดลที่มีประสิทธิภาพสูง รองรับหลายภาษา และสามารถนำไปประยุกต์ใช้กับงานจริงได้หลากหลาย เช่น การสรุปเนื้อหา การแปลภาษา การวิเคราะห์ข้อความ และ OCR โดยเน้นความปลอดภัย ความเป็นส่วนตัว และความโปร่งใสในการใช้งาน AI

### บริการหลักของ Mistral AI

- **Mistral Large Language Model (LLM):** โมเดลภาษา AI ขนาดใหญ่สำหรับงานสรุปเนื้อหา ตอบคำถาม วิเคราะห์ข้อความ และสร้างเนื้อหาอัตโนมัติ
- **Mistral OCR:** บริการแปลงข้อความจากภาพหรือ PDF เป็นข้อความดิจิทัล รองรับหลายภาษาและรูปแบบเอกสาร
- **Translation:** บริการแปลภาษาด้วย AI ที่แม่นยำและรวดเร็ว
- **Document Summarization:** สรุปเนื้อหาจากเอกสารยาว ๆ ให้สั้น กระชับ เข้าใจง่าย
- **Data Extraction:** ดึงข้อมูลสำคัญจากเอกสาร เช่น ตาราง ตัวเลข หรือข้อมูลเฉพาะทาง
- **Custom AI Solutions:** ให้บริการปรับแต่งโมเดล AI ตามความต้องการของลูกค้าองค์กร

ดูรายละเอียดเพิ่มเติมได้ที่ [https://mistral.ai](https://mistral.ai)

# Mistral OCR คืออะไร? จุดเด่นและความแตกต่าง

Mistral OCR คือบริการ OCR ที่พัฒนาโดย Mistral AI โดดเด่นด้วยความแม่นยำสูง รองรับหลายภาษา และใช้งานผ่าน API ได้ง่าย ต่างจาก OCR ทั่วไปตรงที่มี AI Model ที่ทันสมัยและปรับแต่งได้ตามงานเฉพาะทาง

## ค่าใช้จ่ายของ Mistral OCR

- Mistral OCR คิดค่าบริการตามจำนวนหน้าหรือจำนวนคำที่ประมวลผล
- มีแพ็กเกจฟรีและแบบชำระเงิน ขึ้นกับปริมาณการใช้งาน

# วิธีสมัครและขอ Mistral OCR API Key

1. สมัครสมาชิกที่ [Mistral AI](https://mistral.ai)
2. เข้าสู่ระบบและไปที่หน้า API Management
3. สร้าง API Key ใหม่และคัดลอกเก็บไว้

# Workflow ของโปรเจกต์นี้

```mermaid
sequenceDiagram
    participant User
    participant App
    participant PDFFile
    participant MistralOCR_API
    participant Output

    User->>App: สั่งประมวลผลไฟล์ PDF ทั้งหมดใน input
    loop ทีละไฟล์ PDF
        App->>App: เตรียม output (ลบของเก่า)
        App->>App: แปลง PDF เป็นภาพ PNG ทีละหน้า
        loop ทีละหน้า
            App->>MistralOCR_API: ส่งภาพ (base64) ไปยัง API
            MistralOCR_API-->>App: ส่งผลลัพธ์ JSON (markdown + images)
        end
        App->>App: รวมผลลัพธ์ทุกหน้า
        App->>App: แยกผลลัพธ์แต่ละหน้า
        loop ทีละหน้า
            App->>Output: สร้างโฟลเดอร์ page-x ใน 1.MistralOCR
            App->>App: post-process markdown (fix table, image tag)
            App->>Output: save markdown (page-x.md)
            App->>Output: save images OCR (ถ้ามี)
        end
    end
    App->>User: แสดงผลลัพธ์/สถานะในคอนโซล
```

# อธิบายผลลัพธ์ OCR ที่ได้ (ละเอียด)

- โปรแกรมจะค้นหาไฟล์ PDF ทั้งหมดในโฟลเดอร์ input
- สำหรับแต่ละไฟล์ PDF:
    - แปลง PDF เป็นภาพ PNG ทีละหน้า แล้วส่งไปยัง Mistral OCR API ทีละหน้า
    - รวมผลลัพธ์ JSON ของทุกหน้า
    - สำหรับแต่ละหน้า:
        1. **สร้างโฟลเดอร์** `1.MistralOCR/page-x/`
        2. **Post-process Markdown**
            - ตรวจสอบและปรับรูปแบบตาราง (table) ให้ cell อยู่บรรทัดเดียว
            - ตรวจสอบและแยก image tag (`![...](...)`) ให้อยู่บรรทัดใหม่และมีบรรทัดว่างก่อนหน้า
        3. **บันทึกไฟล์ Markdown**
            - สร้างไฟล์ `page-x.md` ในโฟลเดอร์นั้น
            - เนื้อหา markdown จะมีลิงก์ไปยังภาพต้นฉบับ (../0.SplitPdfToImages/xxx.png)
        4. **บันทึกไฟล์ภาพ OCR**
            - หากในผลลัพธ์มี image OCR (base64) จะถูก decode และ save เป็นไฟล์ภาพในโฟลเดอร์เดียวกัน

- โครงสร้างไฟล์ตัวอย่าง:

```text
docs/output/1.Scanned/
  0.SplitPdfToImages/
    1.Scanned-1.png
    1.Scanned-2.png
  1.MistralOCR/
    page-1/
      page-1.md   <-- มีลิงก์ไปยัง image.jpg
      image.jpg (ไฟล์ภาพ OCR ถ้ามี)
    page-2/
      page-2.md
      ...
```

- ตัวอย่างเนื้อหาในไฟล์
   - [Text Only](./POCMistralOCR/docs/output/1.Scanned/1.MistralOCR/page-1/page-1.md)
   - [Table Only](./POCMistralOCR/docs/output/2.TablePure/1.MistralOCR/page-1/page-1.md)
   - [Image Only](./POCMistralOCR/docs/output/3.Image/1.MistralOCR/page-1/page-1.md)
   - [Text + Table + Image](./POCMistralOCR/docs/output/4.TextWithTableWithImage/1.MistralOCR/)

- ผู้ใช้สามารถเปิดไฟล์ `.md` เพื่อดูผลลัพธ์ข้อความและคลิกดูภาพต้นฉบับแต่ละหน้าได้ทันที

## หมายเหตุและข้อควรรู้เกี่ยวกับการใช้งานโปรเจกต์

- **รองรับเฉพาะไฟล์ PDF**: เวอร์ชันปัจจุบันรองรับเฉพาะไฟล์ PDF ในโฟลเดอร์ `docs/input` หากต้องการรองรับไฟล์ภาพ (JPG, PNG) ต้องพัฒนาเพิ่ม
- **การตั้งชื่อไฟล์ output**: ภาพที่แยกจาก PDF จะถูกตั้งชื่อเป็น `[ชื่อไฟล์ต้นฉบับ]-[เลขหน้า].png` เช่น `1.Scanned-1.png` ส่วน markdown จะอยู่ใน `1.MistralOCR/page-x/page-x.md`
- **output จะถูกลบและสร้างใหม่ทุกครั้ง**: ทุกครั้งที่รันโปรแกรม โฟลเดอร์ output ของแต่ละไฟล์จะถูกลบและสร้างใหม่ ผลลัพธ์เก่าจะหายไป
- **คุณภาพไฟล์ต้นฉบับมีผลต่อผลลัพธ์ OCR**: หาก PDF/ภาพต้นฉบับไม่ชัดเจน มีรอยเปื้อน หรือฟอนต์แปลก อาจทำให้ผลลัพธ์ไม่สมบูรณ์
- **การ post-process markdown**: การจัดรูปแบบตารางและแยก image tag ช่วยให้ markdown อ่านง่ายขึ้นและนำไปใช้งานต่อได้สะดวก
- **ตำแหน่ง output**: ผลลัพธ์ทั้งหมดจะอยู่ใน `docs/output/[ชื่อไฟล์ต้นฉบับ]/`

# วิธีติดตั้ง .NET 8

1. ดาวน์โหลด .NET 8 SDK จาก [Microsoft .NET Download](https://dotnet.microsoft.com/en-us/download/dotnet/8.0)
2. ติดตั้งตามขั้นตอนที่ระบบปฏิบัติการของคุณแนะนำ
3. ตรวจสอบด้วยคำสั่ง `dotnet --version`

# การใช้งาน Mistral OCR และการใส่ API Key ในโปรเจกต์

- นำ API Key ที่ได้มาใส่ในไฟล์ `appsettings.json` หรือกำหนดเป็น Environment Variable
- ตัวอย่างในโปรเจกต์นี้จะอ่าน API Key จากไฟล์คอนฟิก

## ตัวอย่างไฟล์ appsettings.json

```json
{
  "MistralOCR": {
    "ApiKey": "YOUR_API_KEY",
    "Endpoint": "https://api.mistral.ai/v1/chat/completions"
  }
}
```

# ตัวอย่างเอกสาร 4 ประเภทและจุดประสงค์

1. Scanned Document: เอกสารที่สแกนจากกระดาษ
2. Table Pure: เอกสารที่มีตารางเป็นหลัก
3. Image: เอกสารที่เป็นภาพล้วน
4. Text With Table With Image: เอกสารที่มีทั้งข้อความ ตาราง และภาพ

# ทดลองรันโค้ด

1. สั่ง build ด้วย `dotnet build POCMistralOCR/POCMistralOCR.csproj`
2. สั่ง run ด้วย `dotnet run --project POCMistralOCR/POCMistralOCR.csproj`

# อธิบายการทำงานของโค้ดทีละจุด

1. อ่านไฟล์ PDF/ภาพจากโฟลเดอร์ input
2. แปลง PDF เป็นภาพ (ถ้ามี)
3. ส่งภาพไปยัง Mistral OCR API
4. รับข้อความและบันทึกผลลัพธ์
5. แสดงผลลัพธ์ในคอนโซล

# สรุป Recap และแนวทางต่อยอด

- OCR ช่วยลดเวลาการจัดการเอกสาร
- Mistral OCR ใช้งานง่ายและแม่นยำ
- สามารถนำไปต่อยอดกับงาน Automation, Data Extraction, หรือเชื่อมต่อกับระบบอื่น ๆ ได้

หวังว่าบทความนี้จะช่วยให้คุณเข้าใจและเริ่มต้นใช้งาน OCR ด้วย Mistral AI ได้อย่างมั่นใจ!